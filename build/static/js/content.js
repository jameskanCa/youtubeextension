!function(e){function t(t){for(var a,i,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)i=s[d],o[i]&&p.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(l&&l(t);p.length;)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},o={2:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;r.push([300,0,3]),n()}({170:function(e,t){},172:function(e,t){},300:function(e,t,n){"use strict";n.r(t);var a=n(16),o=n.n(a),r=n(25),i=n(10),s=n(15),c=n(30),u=n(29),l=n(31),d=n(117),p=n.n(d),f=n(1),m=n.n(f),h=n(4),v=n.n(h),b=n(307),g=n(302),y=n(303),k=n(9),O=n(311),E=n(304),M=n(306),w=n(305),C=n(308),x=n(310),S=n(22),j=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"storeInitialReview",value:function(){var e=Object(r.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:3001/storeInitialReview",{method:"post",headers:{"Content-Type":"application/json",Accept:"*","Access-Control-Request-Headers":"*","Access-Control-Request-Method":"*"},mode:"cors",body:JSON.stringify(t)});case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()},{key:"storeEndReview",value:function(){var e=Object(r.a)(o.a.mark(function e(t,n){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:3001/storeEndSessionInfo/"+n,{method:"post",headers:{"Content-Type":"application/json",Accept:"*","Access-Control-Request-Headers":"*","Access-Control-Request-Method":"*"},mode:"cors",body:JSON.stringify(t)});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),I=(n(87),function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"getYoutubeCategoryText",value:function(e){switch(e){case 1:return"Film & Animation";case 2:return"Autos & Vehicles";case 10:return"Music";case 15:return"Pets & Animals";case 17:return"Sports";case 18:return"Short Movies";case 19:return"Travel & Events";case 20:return"Gaming";case 21:return"Videoblogging";case 22:return"People & Blogs";case 23:return"Comedy";case 24:return"Entertainment";case 25:return"News & Politics";case 26:return"Howto & Styles";case 27:return"Education";case 28:return"Science & Technology";case 29:return"Nonprofits & Activism";case 30:return"Movies";case 31:return"Anime / Animation";case 32:return"Action / Adventure";case 33:return"Classics";case 34:return"Comedy";case 35:return"Documentary";case 36:return"Drama";case 37:return"Family";case 38:return"Foreign";case 39:return"Horror";case 40:return"Sci - Fi / Fantasy";case 41:return"Thriller";case 42:return"Shorts";case 43:return"Shows";case 44:return"Trailers";default:return"Unknown"}}},{key:"isProcastinationVideo",value:function(e){return 1===e||2===e||10===e||15===e||17===e||18===e||19===e||20===e||23===e||24===e||25===e||29===e||30===e||31===e||32===e||33===e||34===e||36===e||37===e||39===e||40===e||41===e||42===e||43===e||44===e}}]),e}()),T=n(57),R=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"obtainTotalActualVideoDuration",value:function(e,t){return t-e}},{key:"obtainDifferenceInDurationExpectation",value:function(e,t,n){return this.obtainTotalActualVideoDuration(e,t)-n}},{key:"formatReadableTime",value:function(e){var t=T(e);return null!==t.hour||0!==t?t.format("HH:mm:ss"):t.format("mm:ss")}},{key:"formatReadableDuration",value:function(e){var t=this.obtainDurationSeconds(e);return T().seconds(t).format("H mm:ss")}},{key:"obtainDurationSeconds",value:function(e){return T.duration(e,T.ISO_8601).asSeconds()}},{key:"obtainCurrentTime",value:function(){return T().format("MMM/DD/YYYY HH:mm:ss")}},{key:"formatSecondsToMinutes",value:function(e){var t=this.obtainDurationSeconds(e),n=t%60,a=Math.trunc(t/60);return"".concat(a," Minutes ").concat(n," Seconds")}}]),e}(),V=function e(t,n,a,o){Object(i.a)(this,e),this.videoTitle=n,this.videoId=t,this.purposeDescription=a,this.startTime=R.obtainCurrentTime(),this.finishedVideo=o},D=n(118),L=n.n(D),P=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"requestVideoCaption",value:function(e){return new Promise(function(t,n){chrome.runtime.sendMessage({method:"getCaption",languageType:e},function(e){if(null!=e.xmlResult){var a=L.a.xml2json(e.xmlResult,{compact:!0,spaces:4}),o=JSON.parse(a).transcript.text.reduce(function(e,t){return e.concat(t._text).concat(" ")},"");return t(o)}n("Empty xmlResult")})})}},{key:"requestVideoLanguageOptions",value:function(){return new Promise(function(e,t){chrome.runtime.sendMessage({method:"getLanguageOptions"},function(n){if(null!=n.xmlResult){var a=L.a.xml2json(n.xmlResult,{compact:!0,spaces:4}),o=JSON.parse(a);if(null!=o.transcript_list.track){var r=o.transcript_list.track.map(function(e){return{lang_code:e._attributes.lang_code,lang_translated:e._attributes.lang_translated}});return e(r)}return e([])}t("Empty xmlResult")})})}}]),e}(),A=b.a.Panel,N=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={videoType:"",purpose:"",initialRating:"",languageOptions:[],selectedLanguage:""},n.onChange=function(e){n.setState({purpose:e})},n.onClick=function(e){var t=e.key;g.a.info("Click on item ".concat(t)),n.setState({selectedLanguage:t})},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(r.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.requestVideoLanguageOptions();case 2:t=e.sent,this.setState({languageOptions:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"extractVideoId",value:function(e){var t=e.split("v=")[1];return null!==t.indexOf("&")&&-1!=t.indexOf("&")?t.substring(0,t.indexOf("&")):t}},{key:"onSave",value:function(){var e=Object(r.a)(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null==this.state.purpose||this.state.purpose.length<25)){e.next=2;break}return e.abrupt("return");case 2:return t=[new V(this.extractVideoId(this.props.videoMetadata.url),this.props.videoMetadata.videoTitle,this.state.purpose,!1)],e.next=5,j.storeInitialReview({userId:this.props.userId,session:t});case 5:if(null==this.state.languageOptions[0]){e.next=10;break}return e.next=8,P.requestVideoCaption(this.state.selectedLanguage);case 8:n=e.sent,console.log(n);case 10:this.props.onClose(),y.a.open({message:"Saved Succesfully",description:"Remember to use your time wisely!",icon:m.a.createElement(k.a,{type:"smile",style:{color:"#108ee9"}}),style:{zIndex:2147483647,marginTop:100}});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"warnProcastination",value:function(){return I.isProcastinationVideo(Number(this.props.videoMetadata.videoCategory))?m.a.createElement(m.a.Fragment,null,m.a.createElement(O.a,{message:"Procastination Warning",description:"Are you sure you want to view this video? You might just be procastinating!",type:"warning",showIcon:!0}),m.a.createElement(E.a,{orientation:"left"},"Content")):null}},{key:"formatLanguageOptions",value:function(){return m.a.createElement(M.a,{onClick:this.onClick},this.state.languageOptions.map(function(e){return m.a.createElement(M.a.Item,{key:e.lang_code},e.lang_translated)}))}},{key:"render",value:function(){var e=this;return m.a.createElement("div",null,this.warnProcastination(),this.props.videoMetadata.videoTitle,m.a.createElement(w.a,null,m.a.createElement(w.a.Item,{label:"Purpose of Watching"},m.a.createElement(C.a,{placeholder:"Purpose of watching this video.",value:this.state.purpose,onChange:function(t){return e.onChange(t.target.value)}}))),m.a.createElement(x.a,{overlay:this.formatLanguageOptions()},m.a.createElement("a",{className:"ant-dropdown-link"},"Select Transcript Language ",m.a.createElement(k.a,{type:"down"}))),m.a.createElement(S.a,{onClick:function(){e.onSave()}},"Log Session"),m.a.createElement(E.a,{orientation:"left"},"Video Info"),m.a.createElement(b.a,{bordered:!1},m.a.createElement(A,{header:"Description",key:"1"},"Description: ".concat(this.props.videoMetadata.videoDescription)),m.a.createElement(A,{header:"Duration",key:"2"},"Duration: ".concat(R.formatSecondsToMinutes(this.props.videoMetadata.videoDuration))),m.a.createElement(A,{header:"Category",key:"3"},"Category: ".concat(I.getYoutubeCategoryText(Number(this.props.videoMetadata.videoCategory)))),m.a.createElement(A,{header:"Link",key:"4"},"From link: ".concat(this.props.videoMetadata.url))))}}]),t}(m.a.Component),_=function e(t,n,a){Object(i.a)(this,e),this.userId=t,this.finishedVideo=n,this.endTime=R.obtainCurrentTime(),this.notes=a},F=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={videoType:"",notes:"",endRating:""},n.onChange=function(e){n.setState({notes:e})},n.onSave=Object(r.a)(o.a.mark(function e(){var t;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new _(n.props.userId,!0,n.state.notes),j.storeEndReview(t,n.extractVideoId(n.props.videoMetadata.url)),n.props.onClose();case 3:case"end":return e.stop()}},e)})),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"extractVideoId",value:function(e){var t=e.split("v=")[1];return null!==t.indexOf("&")&&-1!=t.indexOf("&")?t.substring(0,t.indexOf("&")):t}},{key:"render",value:function(){var e=this;return m.a.createElement("div",null,this.props.videoMetadata.videoTitle,m.a.createElement(w.a,null,m.a.createElement(w.a.Item,{label:"What did you learn?"},m.a.createElement(C.a,{placeholder:"Enter notes",value:this.state.notes,onChange:function(t){return e.onChange(t.target.value)}}))),m.a.createElement(S.a,{onClick:function(){e.onSave()}},"Log Session"))}}]),t}(m.a.Component),U=n(309),q=function e(t,n,a,o,r){Object(i.a)(this,e),this.url="",this.videoTitle="",this.videoDuration=0,this.videoDescription="",this.videoCategory=0,this.url=t,this.videoTitle=n,this.videoDuration=a,this.videoDescription=o,this.videoCategory=r},H=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={inputText:""},n.userInputting=function(e){console.log(e.target.value),n.setState({inputText:e.target.value})},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return m.a.createElement(U.a,{bottom:!0,width:1200,style:{height:900,top:"80%",position:"fixed "},visible:!0,footer:null,closable:!0,mask:!1},m.a.createElement(C.a,{rows:4,value:this.state.inputText,onChange:this.userInputting}))}}]),t}(m.a.Component),Y=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={userId:"",visibleModal:!1,pauseVideo:!1,url:"",videoMetadata:{},videoActive:!1,showNoteForm:!1,endOfVideo:!1,dataBaseRef:"",caption:"",notification:m.a.createElement("div",null)},n.obtainMetadata=function(e){"updatedLink"===e.type&&n.setState({videoMetadata:e.metadata,url:e.currentURL},Object(r.a)(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=new q(e.currentURL,n.state.videoMetadata.snippet.title,n.state.videoMetadata.contentDetails.duration,n.state.videoMetadata.snippet.description,n.state.videoMetadata.snippet.categoryId),y.a.close(),n.setState({videoMetadata:a,visibleModal:!0});case 3:case"end":return t.stop()}},t)})))},n.obtainUserProfile=function(e){"userProfile"===e.type&&n.setState({userId:e.userId},Object(r.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==n.state.userId&&""!==n.state.userId){e.next=2;break}throw new Error("cannot handle empty userId");case 2:case"end":return e.stop()}},e)})))},n.setVisibleNoteIconStatus=function(e){"removeNoteButton"===e.type&&n.state.notification.close()},n.modalCheck=function(e){"noModal"===e.type&&!0===n.state.visibleModal&&n.setState({visibleModal:!1})},n.pauseVideo=function(){document.getElementsByClassName("ytp-play-button ytp-button")[0].click()},n.setVisible=function(){n.setState({visibleModal:!0})},n.saveDbEntryRef=function(e){n.setState({dataBaseRef:e})},n.storeCaption=function(e){console.log(e),n.setState({caption:e})},n.handleInitialOk=function(e){n.setState({visibleModal:!1,videoActive:!0,readyToPause:!1}),document.getElementsByClassName("ytp-play-button ytp-button")[0].click(),document.querySelector("video").addEventListener("ended",function(){n.setState({endOfVideo:!0,videoActive:!1})})},n.handleEndOk=function(e){n.setState({visibleModal:!1,endOfVideo:!1})},n.openNotification=function(){var e={placement:"bottomRight",message:m.a.createElement(S.a,{type:"primary",onClick:function(){n.setState({showNoteForm:!0})}},"Notes"),duration:0,key:"notesIcon"};y.a.open(e)},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){chrome.runtime.onMessage.addListener(this.obtainMetadata),chrome.runtime.onMessage.addListener(this.obtainUserProfile),chrome.runtime.onMessage.addListener(this.modalCheck),chrome.runtime.onMessage.addListener(this.setVisibleNoteIconStatus)}},{key:"componentWillUpdate",value:function(e,t){t.url!==this.state.url&&(setTimeout(this.pauseVideo,2e3),this.setState({videoActive:!1}),y.a.close("notesIcon"))}},{key:"componentWillUnmount",value:function(){chrome.runtime.onMessage.removeListener(this.obtainMetadata),chrome.runtime.onMessage.removeListener(this.obtainUserProfile),chrome.runtime.onMessage.removeListener(this.modalCheck),chrome.runtime.onMessage.removeListener(this.setVisibleNoteIconStatus),y.a.close("notesIcon")}},{key:"render",value:function(){var e=this;return m.a.createElement(p.a,{head:[m.a.createElement("link",{type:"text/css",rel:"stylesheet",href:chrome.runtime.getURL("/static/css/content.css")}),m.a.createElement("link",{type:"text/css",rel:"stylesheet",href:chrome.runtime.getURL("/static/css/3.chunk.css")}),m.a.createElement("link",{type:"text/css",rel:"stylesheet",href:chrome.runtime.getURL("/static/css/4.chunk.css")})]},m.a.createElement(d.FrameContextConsumer,null,function(t){t.document,t.window;return m.a.createElement("div",null,e.state.visibleModal&&m.a.createElement(U.a,{title:"Youtube Noter",visible:e.state.visibleModal,onOk:e.handleInitialOk,footer:null,maskClosable:!1,closable:!1},m.a.createElement(N,{getDatabaseRef:e.saveDbEntryRef,pauseVideo:e.pauseVideo,readyToPause:e.state.pauseVideo,userId:e.state.userId,videoMetadata:e.state.videoMetadata,onClose:e.handleInitialOk})),e.state.videoActive?e.openNotification():m.a.createElement(m.a.Fragment,null),e.state.showNoteForm&&m.a.createElement(H,null),e.state.endOfVideo&&m.a.createElement(U.a,{title:"Youtube Noter",visible:e.state.endOfVideo,onOk:e.handleEndOk,footer:null,maskClosable:!1,closable:!1},m.a.createElement(F,{databaseKey:e.state.dataBaseRef,onClose:e.handleEndOk,userId:e.state.userId,videoMetadata:e.state.videoMetadata})))}))}}]),t}(m.a.Component),B=document.createElement("div");B.id="my-extension-root",document.body.appendChild(B),v.a.render(m.a.createElement(Y,null),B)},87:function(e,t,n){}});
//# sourceMappingURL=content.js.map