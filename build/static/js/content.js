!function(e){function t(t){for(var a,i,s=t[0],c=t[1],u=t[2],d=0,p=[];d<s.length;d++)i=s[d],r[i]&&p.push(r[i][0]),r[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(l&&l(t);p.length;)p.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(a=!1)}a&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},r={2:0},o=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push([300,0,3]),n()}({170:function(e,t){},172:function(e,t){},300:function(e,t,n){"use strict";n.r(t);var a=n(16),r=n.n(a),o=n(25),i=n(10),s=n(15),c=n(30),u=n(29),l=n(31),d=n(117),p=n.n(d),m=n(1),f=n.n(m),h=n(4),v=n.n(h),b=n(307),y=n(302),g=n(303),k=n(9),O=n(311),M=n(304),E=n(306),w=n(305),C=n(308),x=n(310),S=n(22),j="https://youtube-reminder-server.herokuapp.com",I=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"storeInitialReview",value:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/storeInitialReview"),{method:"post",headers:{"Content-Type":"application/json",Accept:"*","Access-Control-Request-Headers":"*","Access-Control-Request-Method":"*"},mode:"cors",body:JSON.stringify(t)});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t){return e.apply(this,arguments)}}()},{key:"storeEndReview",value:function(){var e=Object(o.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/storeEndSessionInfo/")+n,{method:"post",headers:{"Content-Type":"application/json",Accept:"*","Access-Control-Request-Headers":"*","Access-Control-Request-Method":"*"},mode:"cors",body:JSON.stringify(t)});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),T=(n(87),function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"getYoutubeCategoryText",value:function(e){switch(e){case 1:return"Film & Animation";case 2:return"Autos & Vehicles";case 10:return"Music";case 15:return"Pets & Animals";case 17:return"Sports";case 18:return"Short Movies";case 19:return"Travel & Events";case 20:return"Gaming";case 21:return"Videoblogging";case 22:return"People & Blogs";case 23:return"Comedy";case 24:return"Entertainment";case 25:return"News & Politics";case 26:return"Howto & Styles";case 27:return"Education";case 28:return"Science & Technology";case 29:return"Nonprofits & Activism";case 30:return"Movies";case 31:return"Anime / Animation";case 32:return"Action / Adventure";case 33:return"Classics";case 34:return"Comedy";case 35:return"Documentary";case 36:return"Drama";case 37:return"Family";case 38:return"Foreign";case 39:return"Horror";case 40:return"Sci - Fi / Fantasy";case 41:return"Thriller";case 42:return"Shorts";case 43:return"Shows";case 44:return"Trailers";default:return"Unknown"}}},{key:"isProcastinationVideo",value:function(e){return 1===e||2===e||10===e||15===e||17===e||18===e||19===e||20===e||23===e||24===e||25===e||29===e||30===e||31===e||32===e||33===e||34===e||36===e||37===e||39===e||40===e||41===e||42===e||43===e||44===e}}]),e}()),R=n(57),V=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"obtainTotalActualVideoDuration",value:function(e,t){return t-e}},{key:"obtainDifferenceInDurationExpectation",value:function(e,t,n){return this.obtainTotalActualVideoDuration(e,t)-n}},{key:"formatReadableTime",value:function(e){var t=R(e);return null!==t.hour||0!==t?t.format("HH:mm:ss"):t.format("mm:ss")}},{key:"formatReadableDuration",value:function(e){var t=this.obtainDurationSeconds(e);return R().seconds(t).format("H mm:ss")}},{key:"obtainDurationSeconds",value:function(e){return R.duration(e,R.ISO_8601).asSeconds()}},{key:"obtainCurrentTime",value:function(){return R().format("MMM/DD/YYYY HH:mm:ss")}},{key:"formatSecondsToMinutes",value:function(e){var t=this.obtainDurationSeconds(e),n=t%60,a=Math.trunc(t/60);return"".concat(a," Minutes ").concat(n," Seconds")}}]),e}(),D=function e(t,n,a,r,o){Object(i.a)(this,e),this.videoTitle=n,this.videoId=t,this.purposeDescription=a,this.startTime=V.obtainCurrentTime(),this.finishedVideo=r,this.videoMetadata=o},L=n(118),P=n.n(L),A=function(){function e(){Object(i.a)(this,e)}return Object(s.a)(e,null,[{key:"requestVideoCaption",value:function(e){return new Promise(function(t,n){chrome.runtime.sendMessage({method:"getCaption",languageType:e},function(e){if(null!=e.xmlResult){var a=P.a.xml2json(e.xmlResult,{compact:!0,spaces:4}),r=JSON.parse(a).transcript.text.reduce(function(e,t){return e.concat(t._text).concat(" ")},"");return t(r)}n("Empty xmlResult")})})}},{key:"requestVideoLanguageOptions",value:function(){return new Promise(function(e,t){chrome.runtime.sendMessage({method:"getLanguageOptions"},function(n){if(null!=n.xmlResult){var a=P.a.xml2json(n.xmlResult,{compact:!0,spaces:4}),r=JSON.parse(a);if(null!=r.transcript_list.track){var o=r.transcript_list.track.map(function(e){return{lang_code:e._attributes.lang_code,lang_translated:e._attributes.lang_translated}});return e(o)}return e([])}t("Empty xmlResult")})})}}]),e}(),N=b.a.Panel,_=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={videoType:"",purpose:"",initialRating:"",languageOptions:[],selectedLanguage:""},n.onChange=function(e){n.setState({purpose:e})},n.onClick=function(e){var t=e.key;y.a.info("Click on item ".concat(t)),n.setState({selectedLanguage:t})},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.requestVideoLanguageOptions();case 2:t=e.sent,this.setState({languageOptions:t});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"extractVideoId",value:function(e){var t=e.split("v=")[1];return null!==t.indexOf("&")&&-1!=t.indexOf("&")?t.substring(0,t.indexOf("&")):t}},{key:"onSave",value:function(){var e=Object(o.a)(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null==this.state.purpose||this.state.purpose.length<25)){e.next=2;break}return e.abrupt("return");case 2:return t=[new D(this.extractVideoId(this.props.videoMetadata.url),this.props.videoMetadata.videoTitle,this.state.purpose,!1,this.props.videoMetadata)],e.next=5,I.storeInitialReview({userId:this.props.userId,session:t});case 5:if(null==this.state.languageOptions[0]){e.next=10;break}return e.next=8,A.requestVideoCaption(this.state.selectedLanguage);case 8:n=e.sent,console.log(n);case 10:this.props.onClose(),g.a.open({message:"Saved Succesfully",description:"Remember to use your time wisely!",icon:f.a.createElement(k.a,{type:"smile",style:{color:"#108ee9"}}),style:{zIndex:2147483647,marginTop:100}});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"warnProcastination",value:function(){return T.isProcastinationVideo(Number(this.props.videoMetadata.videoCategory))?f.a.createElement(f.a.Fragment,null,f.a.createElement(O.a,{message:"Procastination Warning",description:"Are you sure you want to view this video? You might just be procastinating!",type:"warning",showIcon:!0}),f.a.createElement(M.a,{orientation:"left"},"Content")):null}},{key:"formatLanguageOptions",value:function(){return f.a.createElement(E.a,{onClick:this.onClick},this.state.languageOptions.map(function(e){return f.a.createElement(E.a.Item,{key:e.lang_code},e.lang_translated)}))}},{key:"render",value:function(){var e=this;return f.a.createElement("div",null,this.warnProcastination(),this.props.videoMetadata.videoTitle,f.a.createElement(w.a,null,f.a.createElement(w.a.Item,{label:"Purpose of Watching"},f.a.createElement(C.a,{placeholder:"Purpose of watching this video.",value:this.state.purpose,onChange:function(t){return e.onChange(t.target.value)}}))),f.a.createElement(x.a,{overlay:this.formatLanguageOptions()},f.a.createElement("a",{className:"ant-dropdown-link"},"Select Transcript Language ",f.a.createElement(k.a,{type:"down"}))),f.a.createElement(S.a,{onClick:function(){e.onSave()}},"Log Session"),f.a.createElement(M.a,{orientation:"left"},"Video Info"),f.a.createElement(b.a,{bordered:!1},f.a.createElement(N,{header:"Description",key:"1"},"Description: ".concat(this.props.videoMetadata.videoDescription)),f.a.createElement(N,{header:"Duration",key:"2"},"Duration: ".concat(V.formatSecondsToMinutes(this.props.videoMetadata.videoDuration))),f.a.createElement(N,{header:"Category",key:"3"},"Category: ".concat(T.getYoutubeCategoryText(Number(this.props.videoMetadata.videoCategory)))),f.a.createElement(N,{header:"Link",key:"4"},"From link: ".concat(this.props.videoMetadata.url))))}}]),t}(f.a.Component),F=function e(t,n,a){Object(i.a)(this,e),this.userId=t,this.finishedVideo=n,this.endTime=V.obtainCurrentTime(),this.notes=a},U=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={videoType:"",notes:"",endRating:""},n.onChange=function(e){n.setState({notes:e})},n.onSave=Object(o.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=new F(n.props.userId,!0,n.state.notes),I.storeEndReview(t,n.extractVideoId(n.props.videoMetadata.url)),n.props.onClose();case 3:case"end":return e.stop()}},e)})),n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"extractVideoId",value:function(e){var t=e.split("v=")[1];return null!==t.indexOf("&")&&-1!=t.indexOf("&")?t.substring(0,t.indexOf("&")):t}},{key:"render",value:function(){var e=this;return f.a.createElement("div",null,this.props.videoMetadata.videoTitle,f.a.createElement(w.a,null,f.a.createElement(w.a.Item,{label:"What did you learn?"},f.a.createElement(C.a,{placeholder:"Enter notes",value:this.state.notes,onChange:function(t){return e.onChange(t.target.value)}}))),f.a.createElement(S.a,{onClick:function(){e.onSave()}},"Log Session"))}}]),t}(f.a.Component),q=n(309),H=function e(t,n,a,r,o){Object(i.a)(this,e),this.url="",this.videoTitle="",this.videoDuration=0,this.videoDescription="",this.videoCategory=0,this.url=t,this.videoTitle=n,this.videoDuration=a,this.videoDescription=r,this.videoCategory=o},Y=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={inputText:""},n.userInputting=function(e){n.setState({inputText:e.target.value})},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return f.a.createElement(q.a,{bottom:!0,width:1200,style:{height:900,top:"80%",position:"fixed"},visible:!0,footer:null,closable:!0,mask:!1},f.a.createElement(C.a,{rows:12,value:this.state.inputText,onChange:this.userInputting}))}}]),t}(f.a.Component),B=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(n=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={userId:"",visibleModal:!1,pauseVideo:!1,url:"",videoMetadata:{},videoActive:!1,showNoteForm:!1,endOfVideo:!1,dataBaseRef:"",caption:"",notification:f.a.createElement("div",null)},n.obtainMetadata=function(e){"updatedLink"===e.type&&n.setState({videoMetadata:e.metadata,url:e.currentURL},Object(o.a)(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=new H(e.currentURL,n.state.videoMetadata.snippet.title,n.state.videoMetadata.contentDetails.duration,n.state.videoMetadata.snippet.description,n.state.videoMetadata.snippet.categoryId),g.a.close(),n.setState({videoMetadata:a,visibleModal:!0});case 3:case"end":return t.stop()}},t)})))},n.obtainUserProfile=function(e){"userProfile"===e.type&&n.setState({userId:e.userId},Object(o.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==n.state.userId&&""!==n.state.userId){e.next=2;break}throw new Error("cannot handle empty userId");case 2:case"end":return e.stop()}},e)})))},n.setVisibleNoteIconStatus=function(e){"removeNoteButton"===e.type&&n.state.notification.close()},n.modalCheck=function(e){"noModal"===e.type&&!0===n.state.visibleModal&&n.setState({visibleModal:!1})},n.pauseVideo=function(){document.getElementsByClassName("ytp-play-button ytp-button")[0].click()},n.setVisible=function(){n.setState({visibleModal:!0})},n.saveDbEntryRef=function(e){n.setState({dataBaseRef:e})},n.storeCaption=function(e){n.setState({caption:e})},n.handleInitialOk=function(e){n.setState({visibleModal:!1,videoActive:!0,readyToPause:!1}),document.getElementsByClassName("ytp-play-button ytp-button")[0].click(),document.querySelector("video").addEventListener("ended",function(){n.setState({endOfVideo:!0,videoActive:!1})})},n.handleEndOk=function(e){n.setState({visibleModal:!1,endOfVideo:!1})},n.openNotification=function(){var e={placement:"bottomRight",message:f.a.createElement(S.a,{type:"primary",onClick:function(){n.setState({showNoteForm:!0})}},"Notes"),duration:0,key:"notesIcon"};g.a.open(e)},n}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){chrome.runtime.onMessage.addListener(this.obtainMetadata),chrome.runtime.onMessage.addListener(this.obtainUserProfile),chrome.runtime.onMessage.addListener(this.modalCheck),chrome.runtime.onMessage.addListener(this.setVisibleNoteIconStatus)}},{key:"componentWillUpdate",value:function(e,t){t.url!==this.state.url&&(setTimeout(this.pauseVideo,2e3),this.setState({videoActive:!1}),g.a.close("notesIcon"))}},{key:"componentWillUnmount",value:function(){chrome.runtime.onMessage.removeListener(this.obtainMetadata),chrome.runtime.onMessage.removeListener(this.obtainUserProfile),chrome.runtime.onMessage.removeListener(this.modalCheck),chrome.runtime.onMessage.removeListener(this.setVisibleNoteIconStatus),g.a.close("notesIcon")}},{key:"render",value:function(){var e=this;return f.a.createElement(p.a,{head:[f.a.createElement("link",{type:"text/css",rel:"stylesheet",href:chrome.runtime.getURL("/static/css/content.css")}),f.a.createElement("link",{type:"text/css",rel:"stylesheet",href:chrome.runtime.getURL("/static/css/3.chunk.css")}),f.a.createElement("link",{type:"text/css",rel:"stylesheet",href:chrome.runtime.getURL("/static/css/4.chunk.css")})]},f.a.createElement(d.FrameContextConsumer,null,function(t){t.document,t.window;return f.a.createElement("div",null,e.state.visibleModal&&f.a.createElement(q.a,{title:"Youtube Noter",visible:e.state.visibleModal,onOk:e.handleInitialOk,footer:null,maskClosable:!1,closable:!1},f.a.createElement(_,{getDatabaseRef:e.saveDbEntryRef,pauseVideo:e.pauseVideo,readyToPause:e.state.pauseVideo,userId:e.state.userId,videoMetadata:e.state.videoMetadata,onClose:e.handleInitialOk})),e.state.videoActive?e.openNotification():f.a.createElement(f.a.Fragment,null),e.state.showNoteForm&&f.a.createElement(Y,null),e.state.endOfVideo&&f.a.createElement(q.a,{title:"Youtube Noter",visible:e.state.endOfVideo,onOk:e.handleEndOk,footer:null,maskClosable:!1,closable:!1},f.a.createElement(U,{databaseKey:e.state.dataBaseRef,onClose:e.handleEndOk,userId:e.state.userId,videoMetadata:e.state.videoMetadata})))}))}}]),t}(f.a.Component),J=document.createElement("div");J.id="my-extension-root",document.body.appendChild(J),v.a.render(f.a.createElement(B,null),J)},87:function(e,t,n){}});
//# sourceMappingURL=content.js.map